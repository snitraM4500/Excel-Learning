<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Excel Concepts</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        /* Custom gradient backgrounds not available in base Tailwind */
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
    </style>
</head>
<body class="min-h-screen p-5 gradient-bg">
    <div class="mb-12">
                <h2 class="text-3xl md:text-4xl text-indigo-600 mb-5 pb-3 border-b-4 border-indigo-600">📈 Advanced Data Analysis with Formulas</h2>
                <p class="mb-4">This section demonstrates a comprehensive Excel worksheet with raw data and calculated columns using formulas. Each derived column builds on the principles from the previous lessons.</p>

                <h3 class="text-2xl text-purple-700 mt-6 mb-4">Sales Performance Analysis - Pokemon Card Store</h3>
                <p class="mb-4">A detailed analysis showing how to use formulas to extract insights from raw sales data. The table includes 2 raw data columns and 12 formula-based calculated columns.</p>

                <div class="overflow-x-auto my-5">
                    <table class="w-full bg-white rounded-lg shadow-md overflow-hidden text-sm" style="min-width: 1400px;">
                        <thead>
                            <tr>
                                <th class="py-3 px-3 text-left font-semibold bg-indigo-600 text-white" title="Raw Data">Product Type</th>
                                <th class="py-3 px-3 text-left font-semibold bg-indigo-600 text-white" title="Raw Data">Units Sold</th>
                                <th class="py-3 px-3 text-left font-semibold bg-purple-700 text-white" title="Formula: =Units * 15">Revenue ($)</th>
                                <th class="py-3 px-3 text-left font-semibold bg-purple-700 text-white" title="Formula: =Revenue * 0.3">Cost (30%)</th>
                                <th class="py-3 px-3 text-left font-semibold bg-purple-700 text-white" title="Formula: =Revenue - Cost">Profit ($)</th>
                                <th class="py-3 px-3 text-left font-semibold bg-purple-700 text-white" title="Formula: =(Profit/Revenue)*100">Profit Margin %</th>
                                <th class="py-3 px-3 text-left font-semibold bg-purple-700 text-white" title="Formula: =Units / SUM(Units)*100">Market Share %</th>
                                <th class="py-3 px-3 text-left font-semibold bg-purple-700 text-white" title="Formula: =Profit / Units">Profit Per Unit</th>
                                <th class="py-3 px-3 text-left font-semibold bg-purple-700 text-white" title="Formula: =IF(Revenue>Mean, Above, Below)">Above/Below Avg</th>
                                <th class="py-3 px-3 text-left font-semibold bg-purple-700 text-white" title="Formula: =IF(Profit Margin>30, High, IF(>20, Medium, Low))">Margin Category</th>
                                <th class="py-3 px-3 text-left font-semibold bg-purple-700 text-white" title="Formula: =Profit * 0.1">Tax (10%)</th>
                                <th class="py-3 px-3 text-left font-semibold bg-purple-700 text-white" title="Formula: =Profit - Tax">Net Profit</th>
                                <th class="py-3 px-3 text-left font-semibold bg-purple-700 text-white" title="Formula: =RANK(Net Profit, all_profits)">Rank</th>
                            </tr>
                        </thead>
                        <tbody id="dataTableBody" class="divide-y divide-gray-200">
                            <!-- Will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>

                <div class="bg-green-50 border-l-4 border-green-500 p-4 my-5 rounded">
                    <strong class="text-green-800">📌 Column Breakdown:</strong><br>
                    <strong>Raw Data (Blue):</strong> Product Type, Units Sold<br>
                    <strong>Calculated Data (Purple):</strong> All remaining columns are derived using Excel formulas that combine, multiply, and analyze the raw data.
                </div>

                <h3 class="text-2xl text-purple-700 mt-6 mb-4">Summary Statistics</h3>
                <div class="overflow-x-auto my-5">
                    <table class="w-full max-w-2xl bg-white rounded-lg shadow-md overflow-hidden">
                        <thead>
                            <tr class="bg-indigo-600 text-white">
                                <th class="py-3 px-4 text-left font-semibold">Metric</th>
                                <th class="py-3 px-4 text-left font-semibold">Value</th>
                                <th class="py-3 px-4 text-left font-semibold">Formula Used</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200">
                            <tr class="hover:bg-gray-50 transition">
                                <td class="py-3 px-4">Total Units Sold</td>
                                <td class="py-3 px-4" id="totalUnits">-</td>
                                <td class="py-3 px-4 font-mono text-pink-600">=SUM(Units)</td>
                            </tr>
                            <tr class="hover:bg-gray-50 transition">
                                <td class="py-3 px-4">Total Revenue</td>
                                <td class="py-3 px-4" id="totalRevenue">-</td>
                                <td class="py-3 px-4 font-mono text-pink-600">=SUM(Revenue)</td>
                            </tr>
                            <tr class="hover:bg-gray-50 transition">
                                <td class="py-3 px-4">Total Profit</td>
                                <td class="py-3 px-4" id="totalProfit">-</td>
                                <td class="py-3 px-4 font-mono text-pink-600">=SUM(Profit)</td>
                            </tr>
                            <tr class="hover:bg-gray-50 transition">
                                <td class="py-3 px-4">Average Profit Per Unit</td>
                                <td class="py-3 px-4" id="avgProfit">-</td>
                                <td class="py-3 px-4 font-mono text-pink-600">=AVERAGE(Profit Per Unit)</td>
                            </tr>
                            <tr class="hover:bg-gray-50 transition">
                                <td class="py-3 px-4">Highest Margin Product</td>
                                <td class="py-3 px-4" id="highestMargin">-</td>
                                <td class="py-3 px-4 font-mono text-pink-600">=MAX(Profit Margin)</td>
                            </tr>
                            <tr class="hover:bg-gray-50 transition">
                                <td class="py-3 px-4">Total Net Profit (After Tax)</td>
                                <td class="py-3 px-4" id="totalNetProfit">-</td>
                                <td class="py-3 px-4 font-mono text-pink-600">=SUM(Net Profit)</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3 class="text-2xl text-purple-700 mt-6 mb-">
                            <tr class="hover:bg-gray-50 transition">
                                <td class="py-3 px-4">Total Net Profit (After Tax)</td>
                                <td class="py-3 px-4" id="totalNetProfit">-</td>
                                <td class="py-3 px-4 font-mono text-pink-600">=SUM(Net Profit)</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3 class="text-2xl text-purple-700 mt-6 mb-4">Final Takeaway</h3>
                <p class="mb-4">Using advanced formulas allows you to transform simple sales data into a powerful, actionable dashboard, helping you to quickly identify top performers, calculate profitability, and make data-driven business decisions.</p>
            </div>
                    
</body>
</html>
